{% extends "base.html" %}
{% block content %}
<div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
  <div class="bg-white rounded shadow p-4">
    <div class="flex items-center justify-between mb-2">
      <h2 class="font-medium">Recent Signals</h2>
      <a href="#" class="text-sm text-blue-600" hx-get="/api/summary" hx-trigger="every 10s" hx-swap="none">Refresh</a>
    </div>
    <div class="overflow-auto max-h-96">
      <table class="min-w-full text-sm">
        <thead class="bg-gray-100 sticky top-0">
          <tr>
            <th class="p-2 text-left">Symbol</th>
            <th class="p-2">TF</th>
            <th class="p-2">Side</th>
            <th class="p-2">Score</th>
            <th class="p-2">Prob%</th>
            <th class="p-2">Price</th>
          </tr>
        </thead>
        <tbody id="signals"
               hx-ext="sse" sse-connect="/stream" sse-swap="signal" hx-swap="beforeend">
          {% for ev in signals %}
            {% include "_row_signal.html" %}
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>

  <div class="bg-white rounded shadow p-4">
    <div class="flex items-center justify-between mb-2">
      <h2 class="font-medium">Orders & TP/SL</h2>
    </div>
    <div class="overflow-auto max-h-96">
      <table class="min-w-full text-sm">
        <thead class="bg-gray-100 sticky top-0">
          <tr>
            <th class="p-2 text-left">Kind</th>
            <th class="p-2">Symbol</th>
            <th class="p-2">Side</th>
            <th class="p-2">Info</th>
          </tr>
        </thead>
        <tbody id="orders" hx-ext="sse" sse-connect="/stream" sse-swap="orders" hx-swap="beforeend">
          {% for ev in orders %}
            {% include "_row_order.html" %}
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>

  <div class="bg-white rounded shadow p-4">
    <div class="flex items-center justify-between mb-2">
      <h2 class="font-medium">Errors</h2>
    </div>
    <div class="overflow-auto max-h-96">
      <table class="min-w-full text-sm">
        <thead class="bg-gray-100 sticky top-0">
          <tr>
            <th class="p-2 text-left">Stage</th>
            <th class="p-2">Symbol</th>
            <th class="p-2">Message</th>
          </tr>
        </thead>
        <tbody id="errors" hx-ext="sse" sse-connect="/stream" sse-swap="errors" hx-swap="beforeend">
          {% for ev in errors %}
            {% include "_row_error.html" %}
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
</div>
{% endblock %}

